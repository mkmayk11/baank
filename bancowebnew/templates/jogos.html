{% extends "base.html" %}
{% block conteudo %}
<div class="casino-background py-5">
    <div class="row justify-content-center">

        <!-- Ca√ßa-n√≠quel -->
        <div class="col-md-8 col-lg-6 mb-5">
            <div class="card p-4 text-center shadow-lg" style="background: radial-gradient(circle, #1a1a1a, #0d0d0d); border-radius: 20px; border: 3px solid #ffdd00;">
                <h2 class="casino-title mb-4">üé∞ Ca√ßa-n√≠quel Vegas</h2>

                <!-- Saldo -->
                <div class="saldo mb-3">
                    <span class="text-warning fw-bold">Saldo:</span> 
                    <span id="saldo" class="text-light fs-5">{{ saldo }}</span>
                </div>

                <!-- Campo de aposta -->
                <form method="POST" id="formCaca">
                    <div class="mb-3">
                        <input type="number" name="aposta" id="apostaSlot" step="0.01" class="form-control form-control-lg text-center" placeholder="Valor da aposta" required style="font-size:1.2rem; border: 2px solid #ffdd00; background-color:#222; color:#fff;">
                    </div>

                    <!-- Rolo da slot machine -->
                    <div class="slot-machine d-flex justify-content-center mb-3" style="gap: 15px;">
                        <div class="reel" id="reel1">{{ rolos[0] if rolos|length > 0 else "üçí" }}</div>
                        <div class="reel" id="reel2">{{ rolos[1] if rolos|length > 1 else "üçã" }}</div>
                        <div class="reel" id="reel3">{{ rolos[2] if rolos|length > 2 else "üîî" }}</div>
                    </div>

                    <!-- Resultados -->
                    <div id="resultadoCaca" class="alert alert-dark mt-3" style="border: 2px solid #ffdd00; color:#fff; font-weight:bold;">
                        {% if resultado_caca %}{{ resultado_caca }}{% endif %}
                    </div>

                    <div id="resultadoRoleta" class="alert alert-dark mt-3" style="border: 2px solid #ffdd00; color:#fff; font-weight:bold;">
                        {% if resultado_roleta %}{{ resultado_roleta }}{% endif %}
                    </div>

                    <button type="submit" class="btn btn-warning fw-bold mt-3" style="font-size:1.2rem; padding:10px 25px; border-radius:10px; box-shadow:0 0 10px #ffdd00;">Girar üé≤</button>
                </form>
            </div>
        </div>

        <!-- Roleta -->
        <div class="col-md-8 col-lg-6 mb-5">
            <div class="card p-4 text-center shadow-lg" style="background: radial-gradient(circle, #1a1a1a, #0d0d0d); border-radius: 20px; border: 3px solid #ffdd00;">
                <h2 class="casino-title mb-4">üé° Roleta</h2>

                <!-- Campo de aposta -->
                <form method="POST" id="formRoleta">
                    <div class="mb-3">
                        <input type="number" name="aposta_roleta" id="apostaRoleta" step="0.01" class="form-control form-control-lg text-center" placeholder="Valor da aposta" required style="font-size:1.2rem; border: 2px solid #ffdd00; background-color:#222; color:#fff;">
                    </div>

                    <div class="mb-3">
                        <select name="numero" class="form-select form-select-lg text-center" required style="font-size:1.2rem; border: 2px solid #ffdd00; background-color:#222; color:#fff;">
                            {% for n in range(0, 37) %}
                            <option value="{{ n }}">{{ n }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <button type="submit" class="btn btn-warning fw-bold mt-3" style="font-size:1.2rem; padding:10px 25px; border-radius:10px; box-shadow:0 0 10px #ffdd00;">Girar üé°</button>
                </form>
            </div>
        </div>

        <!-- Bot√£o voltar -->
        <div class="col-12 text-center mb-5">
            <a href="{{ url_for('dashboard') }}" class="btn btn-light fw-bold" style="font-size:1.2rem; padding:10px 25px; border-radius:10px;">‚¨Ö Voltar ao Dashboard</a>
        </div>

    </div>
</div>

<style>
.casino-background {
    background: url('https://images.unsplash.com/photo-1601999135003-142d1f6aa391?auto=format&fit=crop&w=1950&q=80') no-repeat center center fixed;
    background-size: cover;
    min-height: 100vh;
}

.casino-title {
    color: #ffdd00;
    text-shadow: 0 0 5px #fff, 0 0 10px #ffdd00, 0 0 20px #ffdd00, 0 0 40px #ffdd00;
}

.reel {
    width: 70px;
    height: 70px;
    font-size: 45px;
    line-height: 70px;
    text-align: center;
    border-radius: 10px;
    color: #fff;
    background: linear-gradient(145deg, #444, #000);
    border: 2px solid #ffdd00;
    box-shadow: 0 0 15px #ffdd00, 0 0 30px #ffdd00 inset;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.reel.spin {
    animation: spinAnim 0.2s infinite;
}

@keyframes spinAnim {
    0% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
    100% { transform: translateY(0); }
}
</style>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const reels = [
        document.getElementById("reel1"),
        document.getElementById("reel2"),
        document.getElementById("reel3")
    ];
    const formCaca = document.getElementById("formCaca");
    const formRoleta = document.getElementById("formRoleta");

    const simbolos = [
        "üçí", "üçã", "üîî", "‚≠ê", "üíé", "üçÄ", "üçâ", "ü•≠",
        "üçá", "üçå", "üçì", "üçë", "üçç",
        "ü•ù", "ü••", "üçà", "üåà", "üé≤"
    ];

    // Ca√ßa-n√≠quel: anima√ß√£o dos rolos
    formCaca.addEventListener("submit", function(e){
        e.preventDefault();
        reels.forEach(r => r.classList.add("spin"));

        let spins = 15;
        let intervalo = setInterval(() => {
            reels.forEach(r => r.textContent = simbolos[Math.floor(Math.random() * simbolos.length)]);
            spins--;
            if(spins <= 0){
                clearInterval(intervalo);
                reels.forEach(r => r.classList.remove("spin"));
                formCaca.submit();
            }
        }, 80);
    });

    // Roleta: anima√ß√£o simples de "sorteio"
    formRoleta.addEventListener("submit", function(e){
        e.preventDefault();
        const input = formRoleta.querySelector('select[name="numero"]');
        const resultado = Math.floor(Math.random() * 37);
        alert("N√∫mero sorteado: " + resultado);
        formRoleta.submit();
    });
});
</script>
{% endblock %}
